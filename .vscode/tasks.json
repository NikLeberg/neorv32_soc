{
    // See https://go.microsoft.com/fwlink/?LinkId=733558
    // for the documentation about the tasks.json format
    "version": "2.0.0",
    "type": "shell",
    "presentation": {
        "clear": true,
        "showReuseMessage": false
    },
    "problemMatcher": [
        {
            // catches compilation warnings and errors
            // # ** Warning: ../vhdl/example.vhdl(30): (vcom-1400) Synthesis Warning: Signal "a" is read in the process but is not in the sensitivity list.
            // # ** Error: ../vhdl/example.vhdl(31): near "END": (vcom-1576) expecting ';'.
            "pattern": [
                {
                    "regexp": "\\*\\* (Error|Warning).*: \\.(.+)\\((\\d+)\\): (.+)$",
                    "file": 2,
                    "line": 3,
                    "message": 4,
                    "severity": 1
                }
            ],
            "fileLocation": "relative"
        },
        {
            // catches test failures
            // # ** Failure: 1 AND 0 should equal 0.
            // #    Time: 20 ns  Iteration: 0  Process: /example_tb/test File: ../vhdl/example_tb.vhdl
            // # Break in Process test at ../vhdl/example_tb.vhdl line 54
            "pattern": [
                {
                    "regexp": "\\*\\* Failure: (.+)$",
                    "message": 1
                },
                {
                    "regexp": "^.+Time:.+Process:.+File: \\.(.+)",
                    "file": 1
                },
                {
                    "regexp": "^.+Break in Process .* at \\.(.+) line (\\d+)$",
                    "line": 2,
                }
            ],
            "severity": "error",
            "fileLocation": "relative"
        }
    ],
    "tasks": [
        {
            "label": "modelsim-compile",
            "command": "../scripts/modelsim_compile.tcl",
            "options": {
                "cwd": "./modelsim",
                // shell for running .tcl scripts with modelsim
                "shell": {
                    "executable": "vsim",
                    "args": [
                        "-c",
                        "-do"
                    ]
                }
            }
        },
        {
            "label": "modelsim-test",
            "command": "../scripts/modelsim_test.tcl",
            "options": {
                "cwd": "./modelsim",
                // shell for running .tcl scripts with modelsim
                "shell": {
                    "executable": "vsim",
                    "args": [
                        "-c",
                        "-do"
                    ]
                }
            },
            "dependsOn": [
                "modelsim-compile"
            ]
        },
        {
            "label": "modelsim-open",
            "command": "../scripts/modelsim_open.tcl ${fileBasenameNoExtension}",
            "options": {
                "cwd": "./modelsim",
                // shell for running .tcl scripts with modelsim (gui mode)
                "shell": {
                    "executable": "vsim",
                    "args": [
                        "-do"
                    ]
                }
            },
            "dependsOn": "modelsim-test"
        },
        {
            "label": "quartus-project",
            "command": "../scripts/quartus_project.tcl",
            "options": {
                "cwd": "./quartus",
                // shell for running .tcl scripts with quartus
                "shell": {
                    "executable": "quartus_sh",
                    "args": [
                        "-t",
                    ]
                }
            }
        },
        {
            "label": "quartus-compile",
            "command": "../scripts/quartus_compile.tcl",
            "options": {
                "cwd": "./quartus",
                // shell for running .tcl scripts with quartus
                "shell": {
                    "executable": "quartus_sh",
                    "args": [
                        "-t",
                    ]
                }
            },
            "dependsOn": [
                "quartus-project"
            ]
        },
        {
            "label": "quartus-open",
            "command": "../scripts/quartus_open.tcl",
            "options": {
                "cwd": "./quartus",
                // shell for running .tcl scripts with quartus
                "shell": {
                    "executable": "quartus_sh",
                    "args": [
                        "-t",
                    ]
                }
            },
            "dependsOn": [
                "quartus-project"
            ]
        },
        {
            "label": "quartus-flash",
            "command": "quartus_pgm -c USB-Blaster --mode jtag --operation='p;rpn.sof'",
            "options": {
                "cwd": "./quartus/output_files"
            },
            "dependsOn": [
                "quartus-compile"
            ]
        },
        {
            "label": "clean",
            "command": "Remove-Item -Path quartus/*, modelsim/* -Exclude *gitkeep -Recurse"
        }
    ]
}